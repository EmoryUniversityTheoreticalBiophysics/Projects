function err_ = err_BVlogistic(fits, xs, ps)%% fits are:%   1. bias%   2. slope%   end. lapse%% xs column are:%   1. ones for bias%   2. independent variable%% ps columns are:%   1. ps%   2. ns% logist-it!ps_hat = fits(end)+(1-2*fits(end))*1./(1+exp(-(xs*fits(1:end-1)')));% Avoid log 0TINY = 0.0001;ps_hat(ps_hat==0) = TINY;ps_hat(ps_hat==1) = 1 - TINY;% see appendix of Watson's "Probability summation over time" (1978)% paper for derivationif size(ps,2)==2    err_ = -sum(ps(:,2).*(ps(:,1).*log(ps_hat) + (1-ps(:,1)).*log(1-ps_hat)));else    err_ = -sum((ps.*log(ps_hat) + (1-ps).*log(1-ps_hat)));end    